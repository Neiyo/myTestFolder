<script type="text/javascript">
if (!Array.prototype.reduce){
 Array.prototype.reduce = function(fun){
    var len = this.length;
    if (typeof fun != "function"){
      throw new TypeError();
    }
      
    if (len == 0 && arguments.length == 1){
      throw new TypeError();
    }
    
    var i = 0;
    if (arguments.length >= 2) {
     var rv = arguments[1];
    }
    else{
     do
     {
      if (i in this){
       rv = this[i++];
       break;
      }
   
      // if array contains no values, no initial value to return
      if (++i >= len){
        throw new TypeError();
      }
     }
     while (true);
    }
   
    for (; i < len; i++){
     if (i in this){
        rv = fun.call(null, rv, this[i], i, this);
     }
    }
   
    return rv;
 };
}
console.log([1,2,3,4].reduce(function(a,b){
  return a+b;
}));
</script>
